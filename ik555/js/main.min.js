const header=document.querySelector(".header"),iconMenu=document.querySelector(".icon-menu"),modal=document.querySelectorAll(".modal"),modOpenBtn=document.querySelectorAll(".mod-open-btn"),modCloseBtn=document.querySelectorAll(".mod-close-btn"),successModal=document.querySelector("#success-mod"),errorModal=document.querySelector("#error-mod"),dropdown=document.querySelectorAll(".dropdown");let animSpd=400,desktopW=1260.98,tabletW=1024.98,mob=767.98;function sprite(e){return'<svg><use xlink:href="img/icons/sprite.svg#'+e+'"></use></svg>'}function scrollPos(){return window.pageYOffset||document.documentElement.scrollTop}function enableScroll(){document.querySelectorAll(".fixed-block")&&document.querySelectorAll(".fixed-block").forEach((e=>e.style.paddingRight="0px")),document.body.style.paddingRight="0px",document.body.classList.remove("no-scroll")}function disableScroll(){let e=window.innerWidth>350?window.innerWidth-document.documentElement.clientWidth+"px":0;document.querySelectorAll(".fixed-block")&&document.querySelectorAll(".fixed-block").forEach((t=>t.style.paddingRight=e)),document.body.style.paddingRight=e,document.body.classList.add("no-scroll")}function smoothDrop(e,t,r=!1){let o=r||500;if(t.style.overflow="hidden",t.style.transition=`all ${o}ms ease`,t.style["-webkit-transition"]=`all ${o}ms ease`,e.classList.contains("active")){e.parentNode.classList.remove("active");let r=t.clientHeight+"px";t.style.height=r,setTimeout((function(){t.style.height="0",setTimeout((()=>{t.style.display="none",t.style.height=null,e.classList.remove("active")}),o)}),0)}else{e.parentNode.classList.add("active"),t.style.display="block";let r=t.clientHeight+"px";t.style.height="0px",setTimeout((function(){t.style.height=r,setTimeout((()=>{t.style.height=null,e.classList.add("active")}),o)}),0)}}const customScroll=document.querySelectorAll(".custom-scroll");let isFirefox="undefined"!=typeof InstallTrigger;isFirefox&&(document.documentElement.style.scrollbarColor="#231f2033 #F8F8F8"),isFirefox&&customScroll&&customScroll.forEach((e=>{e.style.scrollbarColor="#231f2033 #F8F8F8"}));let dropdownTimeout,lastScroll=scrollPos();function openModal(e){let t=document.querySelector(".modal.open");t||header.classList.contains("show-menu")||disableScroll(),t&&t.classList.remove("open"),e.classList.add("open")}function closeModal(e){e.classList.remove("open"),setTimeout((()=>{header.classList.contains("show-menu")||enableScroll()}),animSpd)}function openDropdown(e){if(e.classList.add("open"),e.setAttribute("aria-expanded",!0),e.querySelectorAll(".dropdown__options input").forEach((t=>{t.addEventListener("change",(r=>{setActiveOption(e,t.value)}))})),document.addEventListener("click",(function t(r){e.contains(r.target)||(closeDropdown(e),document.removeEventListener("click",t))})),window.innerWidth<tabletW&&e.closest(".orders-filter")){clearTimeout(dropdownTimeout),e.querySelector(".dropdown__body").style.display="block";let t=e.querySelector(".dropdown__body").clientHeight+"px";e.querySelector(".dropdown__body").style.height="0px",setTimeout((function(){e.querySelector(".dropdown__body").style.height=t,dropdownTimeout=setTimeout((()=>{e.querySelector(".dropdown__body").style.height=null}),500)}),0)}}function setActiveOption(e,t){if(e.classList.contains("radio-select")){if("all"==t)e.querySelector(".dropdown__header").classList.remove("checked"),e.querySelector(".dropdown__header span").innerHTML=e.querySelector(".dropdown__header span").getAttribute("data-init-text")||"Не выбрано";else{e.querySelector(".dropdown__header").classList.add("checked");let t=e.querySelector("input:checked").nextElementSibling.innerHTML;e.querySelector(".dropdown__header span").innerHTML=t}closeDropdown(e)}}function uncheckSelectOptions(e){e.querySelectorAll("input").forEach((e=>{e.removeAttribute("checked"),e.checked=!1})),e.querySelector(".dropdown__header").classList.remove("checked"),e.querySelector(".dropdown__header span").innerHTML=e.querySelector(".dropdown__header span").getAttribute("data-init-text")||"Не выбрано"}function closeDropdown(e){if(e.classList.remove("open"),e.setAttribute("aria-expanded",!1),window.innerWidth<tabletW&&e.closest(".orders-filter")){clearTimeout(dropdownTimeout);let t=e.querySelector(".dropdown__body").clientHeight+"px";e.querySelector(".dropdown__body").style.height=t,setTimeout((function(){e.querySelector(".dropdown__body").style.height="0",dropdownTimeout=setTimeout((()=>{e.querySelector(".dropdown__body").style.display="none",e.querySelector(".dropdown__body").style.height=null}),500)}),0)}}function setSuccessTxt(e=!1,t=!1,r=!1){successModal.querySelector("h2").textContent=e||"Заявка успешно отправлена",successModal.querySelector(".main-btn").textContent=r||"Закрыть",t&&(successModal.querySelector("p").textContent=t)}function setErrorTxt(e=!1,t=!1,r=!1){errorModal.querySelector("h2").textContent=e||"Ошибка",errorModal.querySelector(".main-btn").textContent=r||"Закрыть",t&&(errorModal.querySelector("p").textContent=t)}function openSuccessMod(e=!1,t=!1,r=!1){setSuccessTxt(e,t,r),openModal(successModal)}function openErrorMod(e=!1,t=!1,r=!1){setErrorTxt(e,t,r),openModal(errorModal)}function formSuccess(e){e.querySelectorAll(".item-form").forEach((e=>e.classList.remove("error"))),e.querySelectorAll("input").forEach((e=>{["hidden","checkbox","radio"].includes(e.type)||(e.value=""),["checkbox","radio"].includes(e.type)&&!e.classList.contains("required")&&(e.checked=!1)})),e.querySelector("textarea")&&(e.querySelector("textarea").value=""),e.querySelector(".file-form__items")&&(e.querySelector(".file-form__items").innerHTML="")}window.addEventListener("scroll",(()=>{scrollPos()>1?(header.classList.add("scroll"),header.classList.contains("header--main")&&header.classList.remove("header--light"),scrollPos()>lastScroll&&scrollPos()>150&&!header.classList.contains("unshow")?header.classList.add("unshow"):scrollPos()<lastScroll&&header.classList.contains("unshow")&&header.classList.remove("unshow")):(header.classList.remove("scroll"),header.classList.remove("unshow"),header.classList.contains("header--main")&&header.classList.add("header--light")),lastScroll=scrollPos()})),modal&&modal.forEach((e=>{e.addEventListener("click",(t=>{(!e.querySelector(".modal__content").contains(t.target)||e.querySelector(".btn-close").contains(t.target)||e.querySelector(".modal__close")&&e.querySelector(".modal__close").contains(t.target))&&closeModal(e)}))})),modOpenBtn&&modOpenBtn.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let r=e.getAttribute("data-modal");openModal(document.getElementById(r))}))})),modCloseBtn&&modCloseBtn.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let r=e.getAttribute("data-modal");closeModal(document.getElementById(r))}))})),dropdown&&dropdown.forEach((e=>{e.querySelector(".dropdown__header").addEventListener("click",(()=>{e.classList.contains("open")?closeDropdown(e):openDropdown(e)}))}));const searchForm=document.querySelectorAll(".search-form");function showResetBtn(e){e.querySelector("input").value.length>0?e.querySelector(".search-form__reset").classList.add("show"):e.querySelector(".search-form__reset").classList.remove("show")}searchForm&&searchForm.forEach((e=>{showResetBtn(e),e.querySelector("input").addEventListener("input",(()=>showResetBtn(e))),e.addEventListener("reset",(()=>{e.classList.remove("show-results"),e.querySelector("input").setAttribute("value",""),showResetBtn(e)}))}));const itemFormPass=document.querySelectorAll(".item-form--password");itemFormPass&&itemFormPass.forEach((e=>{e.querySelector(".item-form__eye").addEventListener("click",(()=>{e.classList.toggle("show-password"),e.classList.contains("show-password")?e.querySelector("input").type="text":e.querySelector("input").type="password"}))}));const inp=document.querySelectorAll("input[type=tel]");function isPhone(e){return!!e.match(/^\+7 \d{3} \d{3}-\d{2}-\d{2}$/)}function maskEmail(e){const[t,r]=e.split("@");let o="";return o=t.length<=3?t.substring(0,1)+"***":t.substring(0,2)+"***"+t.substring(t.length-1),o+"@"+r}inp&&inp.forEach((e=>{Inputmask({mask:"+7 999 999-99-99"}).mask(e)}));let dragEl,fileTypes=["image/png","image/jpeg","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application / vnd.openxmlformats - officedocument.presentationml.presentation"];function addFile(e,t){for(let r=0;r<e.length;r++){let o=e[r];if(o.size>3145728)return t.querySelector("input").value="",t.classList.add("error"),t.querySelectorAll(".file-form__item").forEach((e=>e.remove())),void(t.querySelector("[data-error]").textContent="Файл должен быть менее 3 МБ");if(!fileTypes.includes(o.type))return t.querySelector("input").value="",t.classList.add("error"),t.querySelectorAll(".file-form__item").forEach((e=>e.remove())),void(t.querySelector("[data-error]").textContent="Разрешённые форматы: png, jpg, jpeg, pdf, doc, docx, ppt, pptx");{t.classList.remove("error"),t.querySelector("[data-error").textContent="";let e=new FileReader;e.readAsDataURL(o),e.onload=()=>{t.querySelector(".file-form__items").insertAdjacentHTML("afterbegin",`<div class="file-form__item">\n                        <div class="file-form__info">\n                            <div class="file-form__name">${o.name}</div>\n                            <div class="file-form__size">${Math.ceil(o.size/1024/1024*100)/100} Mb</div>\n                        </div>\n                        <div class="file-form__del">Удалить</div>\n                     </div>\n                    `)},e.onerror=()=>{console.log(e.error)}}}}function toggleAccordion(e){e.parentNode.parentNode.querySelectorAll(".accordion").forEach((t=>{if(t.querySelector(".accordion__header").classList.contains("active")&&(smoothDrop(t.querySelector(".accordion__header"),t.querySelector(".accordion__body")),t.getBoundingClientRect().top<0)){let r=scrollPos()+e.getBoundingClientRect().top-t.querySelector(".accordion__body").clientHeight-header.clientHeight-10;window.scrollTo(0,r)}})),smoothDrop(e.querySelector(".accordion__header"),e.querySelector(".accordion__body"))}document.querySelector(".file-form")&&document.querySelectorAll(".file-form").forEach((e=>{e.querySelector("input").addEventListener("change",(t=>{e.querySelectorAll(".file-form__item").forEach((e=>e.remove())),addFile(t.target.files,e)})),e.addEventListener("click",(t=>{e.querySelectorAll(".file-form__del").forEach(((r,o)=>{if(r.contains(t.target)){const t=new DataTransfer,l=e.querySelector("input"),{files:s}=l;for(let e=0;e<s.length;e++){let r=s[e];e!==o&&t.items.add(r)}l.files=t.files,setTimeout((()=>{r.parentNode.remove()}),0)}}))})),dragEl=e,dragEl.addEventListener("dragenter",(e=>{e.preventDefault()})),dragEl.addEventListener("dragover",(e=>{e.preventDefault()})),dragEl.addEventListener("dragleave",(e=>{e.preventDefault()})),dragEl.addEventListener("drop",(function(t){t.preventDefault();const r=new DataTransfer;if(e.querySelector("input").hasAttribute("multiple"))for(let e=0;e<t.dataTransfer.files.length;e++)r.items.add(t.dataTransfer.files[e]);else r.items.add(t.dataTransfer.files[0]);let o=Array.from(r.files);e.querySelector("input").files=r.files,e.querySelectorAll(".file-form__item").forEach((e=>e.remove())),addFile(o,e)}))})),iconMenu&&iconMenu.addEventListener("click",(()=>{header.classList.contains("show-menu")?(enableScroll(),header.classList.remove("show-menu"),iconMenu.setAttribute("aria-label","Открыть меню")):(disableScroll(),header.classList.add("show-menu"),iconMenu.setAttribute("aria-label","Закрыть меню"),window.addEventListener("resize",(()=>{header.classList.contains("show-menu")&&window.innerWidth>desktopW&&iconMenu.click()})))}));const articleSwiper=document.querySelector(".article__swiper");if(articleSwiper){new Swiper(articleSwiper.querySelector(".swiper"),{observe:!0,observeParents:!0,effect:"fade",fadeEffect:{crossFade:!0},speed:800,allowTouchMove:!1,pagination:{el:articleSwiper.querySelector(".swiper-pagination"),type:"bullets",clickable:!0},navigation:{nextEl:articleSwiper.querySelector(".nav-btn--next"),prevEl:articleSwiper.querySelector(".nav-btn--prev")}})}const disabledForm=document.querySelectorAll(".disabled-form");function checkForm(e){let t=Array.from(e.querySelectorAll("input.required")).find((e=>{if(e.value&&"tel"===e.type&&!isPhone(e.value)||!e.value)return e}));t?e.querySelector("button[type=submit]").setAttribute("disabled",!0):e.querySelector("button[type=submit]").removeAttribute("disabled")}let codeResTimeout;function resetPassword(e){clearTimeout(codeResTimeout),document.querySelector(".resend-pass__btn").setAttribute("disabled",!0);let t=+document.querySelector("[data-pass-form=send-pass]").getAttribute("data-timeout")||30;document.querySelector("[data-pass-form=send-pass]").style.display="none",document.querySelector(".resend-pass__timeout").style.display="block",document.querySelector(".reset-pass-txt")&&(document.querySelector(".reset-pass-txt").textContent=`Мы отправили письмо на электронный адрес ${maskEmail(e)}`),document.querySelector("[data-pass-form=resend-pass]").style.display="block",function e(){t>0?(document.querySelector(".resend-pass__min").textContent=parseInt(t/60),document.querySelector(".resend-pass__sec").textContent=t%60<10?"0"+t%60:t%60,codeResTimeout=setTimeout(e,1e3)):(clearTimeout(codeResTimeout),document.querySelector(".resend-pass__timeout").style.display="none",document.querySelector(".resend-pass__btn").removeAttribute("disabled")),t--}()}disabledForm.length>0&&disabledForm.forEach((e=>{e.querySelectorAll("input.required").length>0&&(checkForm(e),e.querySelectorAll("input.required").forEach((t=>{t.addEventListener("change",(()=>{checkForm(e)}))})))}));const orders=document.querySelector(".orders"),ordersFilterBtn=document.querySelector(".filter-btn"),ordersFilter=document.querySelector(".orders-filter"),ordersSort=document.querySelectorAll(".orders__cols [data-sortBy]");function checkSelectedCount(){let e=0;const t=ordersFilter.querySelector(".status-select input:checked");t&&"all"!==t.value&&e++,ordersFilter.querySelectorAll(".js-datepicker").forEach((t=>t.value?e++:"")),document.querySelector(".filter-btn__count").textContent=e>0?e:"",e>0?ordersFilterBtn.classList.add("is-filtered"):ordersFilterBtn.classList.remove("is-filtered")}function initOrderDatepicker(){ordersFilter.querySelectorAll(".js-datepicker").length>0&&ordersFilter.querySelectorAll(".js-datepicker").forEach((e=>{flatpickr(e,{dateFormat:"d.m.Y",locale:"ru",disableMobile:"true",onChange:function(t,r,o){if(t.length>0&&"start-date"==e.getAttribute("data-name")){let r=t[0],o=e.closest(".form__grid").querySelector("[data-name=end-date]")._flatpickr;o&&o.selectedDates.length>0&&r>o.selectedDates[0]&&o.setDate(r),o&&o.set("minDate",r)}checkSelectedCount()}})}))}function resetOrderDatepicker(){ordersFilter.querySelectorAll(".js-datepicker").length>0&&ordersFilter.querySelectorAll(".js-datepicker").forEach((e=>{e._flatpickr&&e._flatpickr.clear()}))}function showOrderFilter(){window.innerWidth<tabletW&&disableScroll(),document.querySelector(".overlay").addEventListener("click",(function e(){ordersFilterBtn.classList.contains("active")&&window.innerWidth<tabletW&&(unshowOrderFilter(),document.removeEventListener("click",e))})),ordersFilterBtn.classList.add("active"),ordersFilter.classList.add("show"),document.querySelector(".overlay").classList.add("show")}function unshowOrderFilter(){enableScroll(),ordersFilterBtn.classList.remove("active"),ordersFilter.classList.remove("show"),document.querySelector(".overlay").classList.remove("show")}function resetOrderFilter(){resetOrderDatepicker(),ordersFilter.querySelectorAll("[data-order-type]").length>0&&ordersFilter.querySelectorAll("[data-order-type]")[0].click(),ordersFilter.querySelectorAll(".status-select").forEach((e=>{uncheckSelectOptions(e)})),checkSelectedCount()}ordersFilter&&(ordersFilterBtn.addEventListener("click",showOrderFilter),ordersFilter.querySelector(".btn-close").addEventListener("click",unshowOrderFilter),ordersFilter.querySelector(".orders-filter__close").addEventListener("click",unshowOrderFilter),window.addEventListener("resize",(()=>{ordersFilterBtn.classList.contains("active")&&window.innerWidth>tabletW&&enableScroll()})),ordersFilter.querySelectorAll(".service-select input").forEach((e=>{e.addEventListener("change",(()=>{let t=e.getAttribute("data-order-type");ordersFilter.querySelectorAll(".status-select").forEach((e=>{e.getAttribute("data-order-status")!=t?(uncheckSelectOptions(e),e.classList.remove("current")):e.classList.add("current")})),checkSelectedCount()}))})),ordersFilter.querySelectorAll(".status-select input").forEach((e=>{e.addEventListener("change",checkSelectedCount)})),initOrderDatepicker(),ordersFilter.querySelector("form").addEventListener("reset",resetOrderFilter)),orders&&orders.addEventListener("click",(e=>{document.querySelectorAll(".orders__cols [data-sortBy]").length>0&&document.querySelectorAll(".orders__cols [data-sortBy]").forEach((t=>{if(t.contains(e.target))if(t.classList.contains("active")){let e=t.getAttribute("data-order");t.setAttribute("data-order","asc"===e?"desc":"asc")}else ordersSort.forEach((e=>{e.classList.remove("active"),e.setAttribute("data-order","asc")})),t.classList.add("active")})),orders.querySelectorAll(".accordion").length>0&&orders.querySelectorAll(".accordion").forEach((t=>{t.querySelector(".accordion__header").contains(e.target)&&toggleAccordion(t)})),orders.querySelectorAll(".order-mod-open-btn").length>0&&orders.querySelectorAll(".order-mod-open-btn").forEach((t=>{if(t.contains(e.target)){e.preventDefault();let r=t.getAttribute("data-modal"),o=t.getAttribute("data-order-number");document.getElementById(r).querySelector(".order-details p").textContent=o||"",document.getElementById(r).querySelector("input[name=order-number]").value=o||"",openModal(document.getElementById(r))}}))}));